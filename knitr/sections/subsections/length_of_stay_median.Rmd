#### Time-Series Plots

These time-series plots show the trends over time *before* the removal of any potentially spurious data points and the balancing of the panels.  They are presented for that very purpose, identification of possibly spurious data points.

##### Case Sites

```{r mode_of_arrival_any_time_series_plot_case, echo = FALSE, cache = FALSE, results = 'hide', eval = TRUE}
closed_ts_plot(indicator = 'length of stay',
               sub.indicator = 'median',
               steps = TRUE,
               theme = theme_bw(),
               tidy  = FALSE,
               facet = FALSE,
               sites = c('Bishop Auckland', 'Hartlepool', 'Hemel Hempstead', 'Newark', 'Rochdale'),)
```

##### Control Sites

```{r mode_of_arrival_any_time_series_plot_control, echo = FALSE, cache = FALSE, results = 'hide', eval = TRUE}
closed_ts_plot(indicator = 'length of stay',
               sub.indicator = 'median',
               steps = TRUE,
               theme = theme_bw(),
               tidy  = FALSE,
               facet = FALSE,
               sites = c('Salford', 'Scarborough', 'Whitehaven',
                         'Blackburn', 'Grimsby', 'Wigan',
                         'Basingstoke', 'Warwick', 'Yeovil',
                         'Carlisle', 'Salisbury', 'Southport',
                          'Rotherham', 'Scunthorpe', 'Wansbeck'))
```

##### Bishop Auckland

```{r mode_of_arrival_any_time_series_plot_bishop, echo = FALSE, cache = FALSE, results = 'hide', eval = TRUE}
closed_ts_plot(indicator = 'length of stay',
               sub.indicator = 'median',
               steps = TRUE,
               theme = theme_bw(),
               tidy  = FALSE,
               facet = FALSE,
               sites = c('Bishop Auckland', 'Salford', 'Scarborough', 'Whitehaven'))
```

##### Hartlepool

```{r mode_of_arrival_any_time_series_plot_hartlepool, echo = FALSE, cache = FALSE, results = 'hide', eval = TRUE}
closed_ts_plot(indicator = 'length of stay',
               sub.indicator = 'median',
               steps = TRUE,
               theme = theme_bw(),
               tidy  = FALSE,
               facet = FALSE,
               sites = c('Hartlepool', 'Blackburn', 'Grimsby', 'Wigan'))
```

##### Hemel Hempstead

```{r mode_of_arrival_any_time_series_plot_hemel, echo = FALSE, cache = FALSE, results = 'hide', eval = TRUE}
closed_ts_plot(indicator = 'length of stay',
               sub.indicator = 'median',
               steps = TRUE,
               theme = theme_bw(),
               tidy  = FALSE,
               facet = FALSE,
               sites = c('Hemel Hempstead', 'Basingstoke', 'Warwick', 'Yeovil'))
```

##### Newark

```{r mode_of_arrival_any_time_series_plot_newark, echo = FALSE, cache = FALSE, results = 'hide', eval = TRUE}
closed_ts_plot(indicator = 'length of stay',
               sub.indicator = 'median',
               steps = TRUE,
               theme = theme_bw(),
               tidy  = FALSE,
               facet = FALSE,
               sites = c('Newark', 'Carlisle', 'Salisbury', 'Southport'))
```

##### Rochdale

```{r mode_of_arrival_any_time_series_plot_rochdale, echo = FALSE, cache = FALSE, results = 'hide', eval = TRUE}
closed_ts_plot(indicator = 'length of stay',
               sub.indicator = 'median',
               steps = TRUE,
               theme = theme_bw(),
               tidy  = FALSE,
               facet = FALSE,
               sites = c('Rochdale', 'Rotherham', 'Scunthorpe', 'Wansbeck'))
```

#### Model 1
`Case Site    : Individual`\
`Control Site : None`\
`Panel        : ED`\
`Model        : observations ~ season + time + closure + nhs111 + ambulance.divert + other.centre `\

```{r length_of_stay_median_model1, echo = FALSE, cache = FALSE, results = 'markup', eval = TRUE}
length.of.stay.median$model1.ts.plot
length.of.stay.median$model1.forest$forest
length.of.stay.median$model1.panelar$coef[3:8] %>% kable(caption = length.of.stay.median$model1.panelar$caption)
```

#### Model 2

`Case Site    : Individual`\
`Control Site : One Matched`\
`Panel        : ED`\
`Model        : observations ~ season + time + closure * site + nhs111 + ambulance.divert + other.centre `\

```{r length_of_stay_median_model2, echo = FALSE, cache = FALSE, results = 'markup', eval = TRUE}
length.of.stay.median$model2.ts.plot
length.of.stay.median$model2.forest$forest
length.of.stay.median$model2.panelar$coef[3:8] %>% kable(caption = length.of.stay.median$model2.panelar$caption)
```

#### Model 3

`Case Site    : Individual`\
`Control Site : All Matched`\
`Panel        : ED`\
`Model        : observations ~ season + time + closure * site + nhs111 + ambulance.divert + other.centre `\

```{r length_of_stay_median_model3, echo = FALSE, cache = FALSE, results = 'markup', eval = TRUE}
length.of.stay.median$model3.ts.plot
length.of.stay.median$model3.forest$forest
length.of.stay.median$model3.panelar$coef[3:8] %>% kable(caption = length.of.stay.median$model3.panelar$caption)
```

#### Model 4

`Case Site    : All`\
`Control Site : One Matched`\
`Panel        : ED`\
`Model        : observations ~ season + time + closure * site + nhs111 + ambulance.divert + other.centre `\

```{r length_of_stay_median_model4, echo = FALSE, cache = FALSE, results = 'markup', eval = TRUE}
length.of.stay.median$model4.ts.plot.trust
length.of.stay.median$model4.forest$forest
length.of.stay.median$model4.panelar$coef[3:9] %>% kable(caption = length.of.stay.median$model4.panelar$caption)
## length.of.stay.median$model4.ts.plot.lsoa
```

#### Model 5

`Case Site    : All`\
`Control Site : All Matched`\
`Panel        : ED`\
`Model        : observations ~ season + time + closure * site + nhs111 + ambulance.divert + other.centre `\


```{r length_of_stay_median_model5, echo = FALSE, cache = FALSE, results = 'markup', eval = TRUE}
length.of.stay.median$model5.ts.plot.trust
length.of.stay.median$model5.forest$forest
length.of.stay.median$model5.panelar$coef[3:9] %>% kable(caption = length.of.stay.median$model5.panelar$caption)
```

#### Model 6

`Case Site    : Individual`\
`Control Site : One Matched`\
`Panel        : LSOA`\
`Model        : observations ~ season + time + closure * site + nhs111 + ambulance.divert + other.centre  + change in ED time`\

```{r length_of_stay_median_model6, echo = FALSE, cache = FALSE, results = 'markup', eval = TRUE}
length.of.stay.median$model6.ts.plot.trust
length.of.stay.median$model6.forest.model$forest
length.of.stay.median$model6.panelar$coef[3:8] %>% kable(caption = length.of.stay.median$model6.panelar$caption)
```

#### Model 7

Model 7 seeks to analyse at the LSOA level across all case sites and their one matched contorl site the effects of the various steps, and other co-variates.  However, the amount of RAM required by the software is (~26Gb if only one matched control site, rising to 126Gb if all contorl sites are included as there are 2648 LSOAs) exceeds the 16Gb available on the Virtual Machine.

`Case Site    : All`\
`Control Site : One Matched`\
`Panel        : LSOA`\
`Model        : observations ~ season + time + closure * site + nhs111 + ambulance.divert + other.centre  + change in ED time`\

```{r length_of_stay_median_model7, echo = FALSE, cache = FALSE, results = 'markup', eval = TRUE}
length.of.stay.median$model7.ts.plot.trust
length.of.stay.median$model7.forest.model$forest
length.of.stay.median$model7.panelar$coef[3:8] %>% kable(caption = length.of.stay.median$model7.panelar$caption)
```
